---
layout: post
title: "mysql课程笔记"
categories: Tech笔记
tags: mysql
---

* content
{:toc}



## Mysql数据类型简介



#### 1.整数类型、浮点型和定点型

  整数类型

| 整数类型      | 字节数  | 无符号(unsigned)范围        | 有符号( signed ) 范围( 默认)                    |
| --------- | ---- | ---------------------- | ---------------------------------------- |
| TINYINT   | 1    | 0~255                  | -128~127                                 |
| SMALLINT  | 2    | 0~65535                | -32768~32767                             |
| MEDIUMINT | 3    | 0~16777215             | -8388608~8388607                         |
| INT       | 4    | 0~4294967295           | -2147483648~2147483647                   |
| INTEGER   | 4    | 0~4294967295           | -2147483648~2147483647                   |
| BIGINT    | 8    | 0~18446744073709551615 | -9223372036854775808~9223372036854775807 |

 

  浮点类型和定点类型

| 类型           | 字节数  | 无符号( unsigned ) 范围                       | 有符号( signed ) 范围( 默认)                    |
| ------------ | ---- | ---------------------------------------- | ---------------------------------------- |
| FLOAT        | 4    | 0,1.175494351E-38~3.402823466E+38        | -3.402823466E+38~1.175494351E-38,0,1.175494351E-38~3.402823466E+38 |
| DOUBLE       | 8    | 0,2.2250738585072014E-308~1.7976931348623157E-308 | 1.7976931348623157E+308~2.2250738585072014E-308,0,2.2250738585072014E-308~1.7976931348623157E+308 |
| DECIMAL(M,D) | M+2  | 同 Double                                 | 同 Double                                 |

 

`M 表示：数据的总长度(不包括小数点)；`

`D 表示：小数位；`

`例如 decimal(5,2) 123.45`

`存入数据的时候，按四舍五入计算`

 

#### 2.日期与时间类型

| 类型        | 字节数  | 取值范围                                    | 零值                  |
| --------- | ---- | --------------------------------------- | ------------------- |
| YEAR      | 1    | 1910~2155                               | 0000                |
| DATE      | 4    | 1000-01-01~9999-12-31                   | 0000:00:00          |
| TIME      | 3    | -838:59:59~838:59:59                    | 00:00:00            |
| DATETIME  | 8    | 1000-01-01 00:00:00~9999-12-31 23:59:59 | 0000-00-00 00:00:00 |
| TIMESTAMP | 4    | 19700101080001~20380119111407           | 00000000000000      |

 

#### 3.字符串类型

| 类型      | 说明                                      |
| ------- | --------------------------------------- |
| CHAR    | 固定长度字符串                                 |
| VARCHAR | 可变长度字符串                                 |
| TEXT    | 大文本（TINYTEXT,TEXT,MEDIUMTEXT,LONGTEXT ） |
| ENUM    | 枚举类型（只能取一个元素）                           |
| SET     | 集合类型（能取多个元素）                            |

 

#### 4.二进制类型

| 类型           | 说明                               |
| ------------ | -------------------------------- |
| BINARY(M)    | 字节数为 M ，允许长度为 0~M                |
| VARBINARY(M) | 允许长度为 0~M  的变长二进制字符串，字节数为值的长度加 1 |
| BIT(M)       | M  位二进制数据，最多 255 个字节             |
| TINYBLOB     | 可变长二进制数据，最多 255 个字节              |
| BLOB         | 可变长二进制数据，最多（2 16 -1）个字节          |
| MEDIUMBLOB   | 可变长二进制数据，最多（2 24 -1）个字节          |
| LONGBLOB     | 可变长二进制数据，最多（2 32 -1）个字节          |

 

 

## 数据库基本操作

#### 1.显示所有数据库

`Show databases;`

#### 2.创建数据库

  `Create database 数据库名;` 

#### 3.删除数据库

  `Drop database 数据库名;` 

#### 4.使用某个数据库

`use 数据库名;`



## 数据库表基本操作



#### 1.创建表

表是数据库存储数据的基本单位。个一个表包含若干字段或记录 

语法：

`CREATE TABLE 表名( 属性名 数据类型 [完整性约束条件],`

                  `属性名 数据类型 [完整性约束条件],`

                  `.`

                  `.`

                  `属性名 数据表格 [完整性约束条件]`

                 `);` 

 

| 约束条件                        | 说明                                    |
| --------------------------- | ------------------------------------- |
| PRIMARY KEY                 | 标识该属性为该表的主键，可以唯一的标识对应的记录              |
| FOREIGN KEY                 | 标识该属性为该表的外键，与某表的主键关联                  |
| NOT NULL                    | 标识该属性不能为空                             |
| UNIQUE                      | 标识该属性的值是唯一的                           |
| AUTO_INCREMENT              | 标识该属性的值自动增加                           |
| DEFAULT xxx                 | 为该属性设置默认值(设置为xxx)                     |
| DEFAULT CURRENT_TIMESTAMP   | 在创建记录时保存当前时间，仅适用于TIMESTAMP数据列         |
| ON UPDATE CURRENT_TIMESTAMP | 在修改记录时（update）保存当前时间，仅适用于TIMESTAMP数据列 |
| UNSIGNED                    | 使用无符号整数                               |

 

例子：

创建图书类别表：t_bookType

`CREATE TABLE t_booktype(`

`id INT PRIMARY KEY AUTO_INCREMENT,`

`bookTypeName VARCHAR(20),`

`bookTypeDesc VARCHAR(200)`

`);`

 

#### 2.查看表结构

  （1）查看基本表结构：`DESCRIBE(DESC) 表名；`

  （2） 查看表详细结构： `SHOW CREATE TABLE 表名；` 

#### 3.修改表

   （1）修改表名 `ALTER TABLE 旧表名 RENMAE 新表名 ；`

   （2）修改字段 `ALTER TABLE 表名 CHANGE 旧属性名 新属性名 新数据类型`

   （3）增加字段 `ALTER TABLE 表名 ADD 属性名1 数据类型 [完整性约束条件][FIRST |AFTER 属性名 2]`

   （4）删除字段 `ALTER TABLE 表名 DROP 属性名` 

#### 4.删除表

  `DROP TABLE 表名；`

 

## 查询数据

 

#### 1.查询所有字段

   `（1）SELECT 字段1，字段2，字段3...FROM 表名；`

   `（2）SELECT * FROM 表名；` 

#### 2.查询指定字段

   `SELECT 字段1，字段2，字段3...FROM 表名；` 

#### 3.WHERE 条件查询

   `SELECT 字段1，字段2，字段3...FROM 表名 WHERE 条件表达式；` 

#### 4.带IN关键字查询

   `SELECT 字段1，字段2，字段3...FROM 表名 WHERE 字段 [NOT] IN (元素 1，元素 2，元素 3)` 

#### 5.带 BETWEENAND 的范围查询

  `SELECT 字段1，字段2，字段3...FROM 表名 WHERE 字段 [NOT] BETWEEN 取值 1 AND 取值 2；` 

#### 6.带 LIKE 的模糊查询

  `SELECT 字段1，字段2，字段3...FROM 表名 WHERE 字段 [NOT] LIKE ‘字符串’；`

`说明：“%”代表任意字符；“_” 代表单个字符；` 

#### 7.空值查询

  `SELECT 字段1，字段2，字段3...FROM 表名 WHERE 字段 IS [NOT] NULL；`

#### 8.带AND的多条件查询

   SELECT 字段1，字段2...FROM 表名 WHERE 条件表达式1 AND 条件表达式2 [...AND 条件表达式 n] 

#### 9.带 OR 的多条件查询

   `SELECT 字段1，字段2...FROM 表名 WHERE 条件表达式1 OR 条件表达式2 [...OR 条件表达式 n]` 

#### 10.DISTINCT 去重复查询

  `SELECT DISTINCT 字段名 FROM 表名；` 

#### 11.对查询结果排序

   `SELECT 字段 1，字段2...FROM 表名 ORDER BY 属性名 [ASC|DESC]` 

#### 12.GROUP BY 分组查询

 `GROUP BY 属性名 [HAVING 条件表达式`][WITH ROLLUP]

- 单独使用(毫无意义)；

- 与 GROUP_CONCAT()函数一起使用；

- 与聚合函数一起使用；

- 与 HAVING 一起使用(限制输出的结果)；

- 与 WITH ROLLUP 一起使用(最后加入一个总和行)； 


#### 13.LIMIT 分页查询

 `SELECT 字段1，字段2...FROM 表名 LIMIT 初始位置，记录数；` 

#### 14.使用聚合函数查询

##### （1）COUNT()函数

- COUNT()函数用来统计记录的条数；

- 与GROUP BY 关键字一起使用；


##### （2）SUM()函数

- SUM()函数是求和函数；

- 与GROUP BY 关键字一起使用；


##### （3）AVG()函数

- AVG()是求平均值的函数；

- 与GROUP BY 关键字一起使用；


##### （4）MAX()函数

- MAX()函数是求最大值的函数；

- 与GROUP BY 关键字一起使用；


##### （5）MIN()函数

- MIN()函数是求最小值的函数；

- 与GROUP BY 关键字一起使用； 


#### 15.连接查询

连接查询是将两个或两个以上的表按照某个条件连接起来，从中选取需要的数据

##### （1）内连接查询

 内连接是一种常用的连接查询，内链接查询可以查询两个或两个以上的表；

##### （2）外连接查询

 外连接可以查出某一张表的所有信息

 `SELECT 属性名列表 FROM 表名1  LEFT | RIGHT JOIN 表名2  ON 表名1.属性名1 = 表名2.属性名2；`

（1）左连接查询

 可以查出“表名1”的所有记录，而“表名2”中，只能查出匹配的记录

（2）右连接查询

 可以查出“表名2”的所有记录，而“表名1”中，只能查出匹配的记录

##### （3）多条件查询

 

#### 16.子查询

##### （1）带IN 关键字的子查询

 一个查询语句的条件可能落在另一个SELECT语句的查询结果中

##### （2）带比较运算符的子查询

 子查询可以使用比较运算符

##### （3）带Exists关键字的子查询

 假如子查询查询到记录，则进行外层查询，否则，不执行外层查询

##### （4）带Any关键字的子查询

 ANY关键字表示满足其中任一条件

##### （5）带ALL关键字的子查询

 ALL 关键字表示满足所有条件 

#### 17.合并查询结果

 （1）UNION: 使用UNION关键字，数据库系统会将所有的查询结果合并到一起，然后去除相同的记录

 （2）UNION ALL: 使用UNION ALL不会去除相同的记录 

#### 18.为表和字段取别名

1.为表取别名

 格式： 表名 表的别名

2.为字段取别名

 格式： 属性名 [AS] 别名

 

## 插入、更新和删除数据

#### 1.插入数据

##### （1）给表的所有字段插入数据

 格式`：INSERT  INTO 表名 VALUES(值1,值2,值3...)`

##### （2）给指定字段插入数据

 格式：`INSERT  INTO 表名(属性1,属性2, 属性3...)`

##### （3）同时插入多条记录

 `INSERT  INTO  表名[(属性列表)] VALUES(取值列别1),（取值列表2）...`

####  2.更新数据

UPDATE 表名

`SET 属性名1=取值2,属性名2=取值2 ... WHERE 条件表达式`

####  3.删除数据

`DELETE FROM 表名 [WHERE 条件表达式]`



## 索引

#### 1.索引的定义

​    索引是由数据库表中一列或多列组合而成，其作用是提高对表中数据的查询速度，类似于图书的目录，方便快速定位，寻找指定的内容

#### 2.索引的优缺点

- 优点：提高查询的速度；
- 缺点：创建和维护索引的时间增加了；

#### 3.索引的分类

-  普通索引：这类索引可以创建在任何数据类型中

- 唯一性索引：使用UNIQUE参数可以设置，在创建唯一性索引时，限制该索引的值必须是惟一的

-  全文索引：使用FULLTEXT参数可以设置，全文索引只能创建在CHAR,VARCHAR,TEXT类型的字段上。主要作用就是提高查询较大字符串类型的速度，只有MyISAM引擎支持该索引，mysql默认引擎不支持

- 单列索引：单列索引可以给单个字段创建索引，单列索引可以是普通索引，也可以是唯一性索引，还可以是全文索引

- 多列索引：多列索引是在表中的多个字段上创建一个索引

- 空间索引： 使用SPATIAL参数设置空间索引。空间索引只能创建在空间数据类型上，这样可以提高系统获取空间数据的效率，只有MyISAM引擎支持该索引，Mysql默认引擎不支持 


#### 4.创建索引

##### (1)创建表的时候创建索引

`CREATE TABLE 表名 (属性名 数据类型 [完整性约束条件],`
​				     `属性名 数据类型 [完整性约束条件],`
​				     `....`
​				     `属性名 数据类型`
​				     `[UNIQUE | FULLTEXT | SPATIAL ] INDEX| KEY`
​				     `[别名] (属性名 1 [(长度)][ASC | DESC])`
​				     `);`

##### (2)在已存在的表上创建索引

`CREATE [UNIQUE | FULLTEXT | SPATIAL] INDEX 索引名 ON 表名 (属性名 [(长度)][ASC|DESC])`

##### (3)用ALTER TABLE语句来创建索引

`ALTER TABLE 表名 ADD [ UNIQUE | FULLTEXT | SPATIAL ] INDEX 索引名 (属性名 [(长度)][ ASC | DESC])；` 

#### 5.删除索引

`DROP INDEX 索引名 ON 表名;`





