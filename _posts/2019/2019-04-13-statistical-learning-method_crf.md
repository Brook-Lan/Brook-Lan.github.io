---
layout: post
title: 李航《统计学习方法》学习笔记(11)--条件随机场
categories: 读书笔记
tags: 机器学习
---
* content
{:toc}


## 一、条件随机场定义与形式

### 1.1 定义

条件随机场是给定一组输入随机变量条件下另一组输出随机变量的条件概率分布模型，其特点是假设**输出随机变量构成马尔可夫随机场**。

标注问题中常用的是**线性链条件随机场**，线性链条件随机场是输入序列对输出序列预测的判别模型，形式为对数线性模型，其学习方法通常是由极大似然估计或正则化的极大似然估计。

> 马尔可夫性：
>
> $$P(Y_v|X,Y_w,w \neq v)=P(Y_v|X,Y_w,w～ v)​$$
>
> 其中，w~v表示在无向图G=(V,E)中与结点v有边连接的所有结点w，w≠v表示结点v以外的所有结点。
>
> 对于线性链条件随机场，则有:
>
> $$P(Y_i|X,Y_1,\cdots,Y_{i-1},Y_{i+1},\cdots,Y_n)=P(Y_i|X,Y_{i-1},Y_{i+1})$$
>
> 在标注问题中，X表示输入观测序列，Y表示对应的输出标记或状态序列。

### 1.2 参数化形式

设P(Y\|X)为线性链条件随机场，则在随机变量X取值为x的条件下，随机变量Y取值为y的条件概率具有如下形式：

$$P(y|x)=\frac{1}{Z(x)} \exp(\sum_{i,k}\lambda_kt_k(y_{i-1},y_i,x,i)+\sum_{i,l}u_ls_l(y_i,x,i))$$

其中

$$Z(x)=\sum_y\exp(\sum_{i,k}\lambda_kt_k(y_{i-1},y_i,x,i)+\sum_{i,l}u_ls_l(y_i,x,i))$$

式中，$$t_k$$是定义在边上的特正函数，称为**转移特征**，依赖于当前和前一个位置，$$s_l$$是定义在结点上的特征函数，称为**状态特征**，依赖于当前特征。通常特征函数$$t_k,s_k$$取值1或0；当满足条件特征时取1，否则取0。$$\lambda_k和u_l$$是对应的权重，Z(x)是规范化因子。



## 二、概率计算

略

## 三、学习算法

训练数据的对数似然函数为

$$L(w)=L_{\hat P}(P_w)=\log \prod_{x,y}P_w(y|x)^{\hat P(x,y)}=\sum_{x,y}\hat P(x,y)\log P_w(y|x)$$

当$$P_w$$是条件随机场模型时,

$$
\begin{align}
L(w)&=\sum_{x,y}\hat P(x,y)\log P_w(y|x) \\
&=\sum_{x,y}[\hat P(x,y)\sum_{k=1}^Kw_kf_k(y,x)-\hat P(x,y)\log Z_w(x)] \\
&=\sum_{j=1}^N\sum_{k=1}^Kw_kf_k(y_i,x_j)-\sum_{j=1}^Nlog Z_w(x_j)
\end{align}
$$

改进的迭代尺度法通过迭代的方法不断优化对数似然函数改变量的下界，达到极大化对数似然函数的目的。

## 四、预测算法

采用的是**维特比算法**

