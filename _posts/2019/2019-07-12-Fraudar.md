---
layout: post
title: FRAUDAR解读
categories: 论文解读
tags: [风控, 算法]
---
* content
{:toc}
论文地址：[FRAUDAR: Bounding Graph Fraud in the Face of Camouflage](https://www.kdd.org/kdd2016/papers/files/rfp0110-hooiA.pdf)



| 术语                   | 说明                                                         |
| :--------------------- | :----------------------------------------------------------- |
| 二部图                 | 由用户、对象和边组成，用户和对象通过边连接，两者可以是多对多关系 |
| 用户                   | 平台上注册的用户                                             |
| 对象                   | 平台上的对象，与用户一起构成二部图的顶点，如商品、被关注者   |
| 边/连接                | 用户对对象的行为，如商品评论、关注                           |
| 客户                   | 对象本身或所属者，会雇用水军给自己上产品做虚假的正向评论、或买僵尸粉等 |
| 欺诈者/欺诈组/欺诈用户 | 受托于客户，对目标对象做出虚假评论或关注的非常规用户         |

### 一、简介

FRAUDAR算法来源于2016年KDD会议，该论文获得了当年的最佳论文奖。该算法要解决的问题是找出站内最善于伪装的虚假账户簇。其原理是虚假账户会通过增加和正常用户的联系来进行伪装，而这些伪装（边）会形成一个很紧密的子网络，这样就可以通过定义一个全局的度量，再移除二部图结构中的边，使得剩余网络结构对应的度量的值最大，这样就找到了最紧密的子网络，而这个网络就是最可疑的。



### 二、欺诈的表现

观察以下邻接矩阵：

![attacks](/posts_img/2019/Fraudar/attacks.png)

x轴为二部图里的对象，y轴为二部图里的用户，坐标系的黑点表示二部图里的边（以用户对产品做出评价为例）

1. 首先看正常用户和正常产品，从x轴来看，部分产品的评论数的很密集，其余部分很低；从y轴来看，少部分用户很活跃，剩下部分的用户不太活跃，这是符合长尾分布的，是正常的现象
2. (a)中欺诈用户除了对特定产品发表虚假的评论，还通过随机地与其他产品建立边（评论）来把自己的账号伪装成正常用户，所以可以看到下方的camouflage部分是均匀的
3. (b)中欺诈用户则通过频繁评价流行的产品来伪装自己成正常用户，所以下方的camouflag部分是由密到疏的分布
4. (c)中，欺诈用户通过盗用正常用户的账号来给目标产品提交评论，故图上表现为平时不怎么活跃的用户集中对目标产品进行评论。这边我们可能会有疑问，为什么被盗号的账户被盗前对其他产品的评论很少，按理说，被盗的账号应该会出现对从流行产品到不流行的产品的评论有由多到少的分布，然后形成图(b)的那种分布，我的理解是：这种正常活跃的用户会经常登自己的账号，即使被盗号了也能在短时间内找回密码，所以账号不可能被欺诈用户长期盗用



### 三、方案

#### 3.1 思路

通过以上介绍，我们知道，通常情况下，欺诈者们会给受托的对象建立大量的边（连接），从而生成与对象的密集子图（Figure2 中右下角那块密集的区域）。据此，我们可以设计一种密度度量指标，以此来衡量子图的密集程度。

不过，同Figure2展示的一样，对于正常的流行文章，它们天然会形成密集的连接；同时我们还知道，而为了掩盖欺诈行为，欺诈者们还会与其他对象建立连接，使自己表现得跟正常用户一样。由此，我们设计的密度度量还需要能应对这两种情况，避免误把对流行文章建立联系的用户当成欺诈用户及漏掉伪装的欺诈用户，这意味着需要对边降权。

#### 3.2 方案设计

作者设计了一种图的密度度量指标g：

$$g(S)=\frac{f(S)}{|S|} \tag{1}$$

其中 f 为：

$$
\begin{aligned}
f(S) &=f_v(S) + f_{\varepsilon}(S) \\
&=\sum_{i \in S} a_i + \sum_{i,j \in S \wedge (i,j)\in \varepsilon}c_{i,j}
\end{aligned} \tag 2
$$

符号说明：

- S表示二部图的结点集（或子集）
- ｖ表示二部图的结点
- $$\varepsilon$$ 表示二部图里的边
-  $$a_i$$ 表示第ｉ个用户或对象的嫌疑度
- $$c_{i,j}$$ 表示连接用户i和对象j的边的嫌疑度

该度量指标具有以下四个性质：

1. 其他条件相同的情况下，包含更高可疑度节点的子网络比包含较低可疑度节点的子网络更可疑；
2. 其他条件相同的情况下，增加可疑的边使得子网络更可疑；
3. 节点和边的可疑度相同的情况下，大的子网络比小的自网络更可疑；
4. 总的可疑度（结合和边的可疑度之和）相同，节点少的子网络更可疑；

#### 3.3 算法

首先从整个节点集出发，然后选择一个节点并移除，使得剩下节点集的g值最大，然后在剩下的节点里重复前面的移除节点步骤，直至节点集为空。比较上述每一步得到的子网络结构对应的全局的度量，取该值最大的子网络结构。伪码如下：

![sf](/posts_img/2019/Fraudar/fraudar-algorithm.png)

伪码中多了一个建立优先树（第2行）的步骤，用以快速移除图结构的边。

该算法的核心计算过程就是贪心地移除图中的点，使得每次变更 f 的变化最大，在移除一个节点的同时，只有与之相邻的节点会发生变化，那么这样最多产生O(\|E\|)次变更，如果找到合适的数据结构使得访问节点的时间复杂度为O(log\|V\|)，那么总的时间复杂度就是O(NlogN)。

基于这样的考虑建立了优先树，这是一个二叉树，图中的每个节点都是树的一个叶子节点，其父节点为子节点中优先级较高的，树建完之后就可以按照O(log\|V\|)的速度获得优先级最高的节点。

#### 3.4 边嫌疑度的计算

公式(2)中的$$a_i$$和$$c_{i,j}$$是如何得到的呢？作者论文中将$$a_i$$设为0，即：

$$g(S)=\frac{\sum_{i,j \in S \wedge (i,j)\in \varepsilon}c_{i,j}}{|S|} \tag 3​$$

接着就是边嫌疑度$$c_{i,j}$$的设置，一个直观的方法是将图中每个边的嫌疑程度设为相等（为１），但是如同我们前面分析的一样，这样会使得把对流行文章产生连接的用户误判为欺诈用户，同时也无法识别伪装的欺诈者。

作者认为，如果节点i到一个度(联系上下为，这边的“度”应该指的是边的数量)较大的节点j，那么将其边$$c_{i,j}$$的嫌疑降低，这是因为度较大的点本身可能就是很受欢迎的，例如大V和销售良好的商品。这使得我们不是仅仅关注度较大的节点，而是关注dense的子网络。

那么如何对不同度的对象j设置不同的$$c_{i,j}$$呢？

回到Figure2中的邻接矩阵，行代表用户，列代表目标。我们希望降低与度很高的目标连接的边的权重，所以$$c_{i,j}$$有以邻接矩阵中第j列的和为变量的函数得出：$$c_{i.j}=h(d_j)$$，$$d_j$$为第j列上的所有点的和（即前面说的对象的“度”）。

函数h(x)应该是个递减函数，而且应该比 1/x 下降得慢。最后作者从tf-idf中得到灵感，令$$h(x)=1/\log (x+c)​$$，c值是为了避免分母为0，默认为5。

所以g(S)的最终形式为：

$$g(S)=\frac{1}{|S|} {\sum_{i,j \in S \wedge (i,j)\in \varepsilon} \frac{1}{ \log (d_j+c)}} \tag 4 $$





### 四、参考

【1】论文原文

【2】[高密子图挖掘](http://www.sohu.com/a/250871870_395209)

【3】[FRAUDAR: Bounding Graph Fraud in the Face of Camouflage 论文理解及算法解析](http://www.voidcn.com/article/p-vjqyoznr-bpx.html)﻿

【4】[社区检测算法在评论中的应用](https://www.freebuf.com/column/196392.html)

【5】[github代码](https://github.com/rgmining/fraudar)
